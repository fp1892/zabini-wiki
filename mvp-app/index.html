<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>MVP App â€“ Zabini Wiki</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="../assets/wiki.css" />
</head>
<body>

<div id="loginOverlay">
  <div id="loginPanel">
    <h2>MVP App</h2>
    <div class="small">Bitte Passwort eingeben.</div>
    <form id="loginForm" style="margin-top:10px;">
      <input id="passwordInput" type="password" placeholder="Passwort" required />
      <div style="margin-top:10px;"><button type="submit">Anmelden</button></div>
    </form>
    <div id="loginStatus"></div>
  </div>
</div>

<div id="protectedRoot" style="display:none;">
  <div class="container">
    <div class="header">
      <div class="brand">
        <div class="logo">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M4 7l4 6 4-8 4 8 4-6v12H4V7z" stroke="rgba(212,175,55,.95)" stroke-width="1.7" />
          </svg>
        </div>
        <div>
          <h1>MVP APP</h1>
          <div class="subtitle">Alle Buttons, Regeln, Berechnungen & Admin-Workflows</div>
        </div>
      </div>
      <div class="nav">
        <a class="pill" href="/">ğŸ  Wiki</a>
        <a class="pill" href="/mvp-code/">ğŸ“œ MVP Code</a>
      </div>
    </div>

    <div class="card">
      <h2>1) Grundprinzip</h2>
      <p class="kicker">
        Die App verwaltet Personen, Event-Platzierungen (Top 10) und berechnet daraus den â€Next MVPâ€œ.
        Alles wird live fÃ¼r alle synchronisiert (Firestore).
      </p>
      <details open>
        <summary>Objekte</summary>
        <div class="small">
          <b>Person</b> enthÃ¤lt:
          <ul>
            <li><code>name</code></li>
            <li><code>title</code> (â˜…)</li>
            <li><code>blocked</code> (âœ–)</li>
            <li><code>mvpCount</code></li>
            <li><code>cooldownLeft</code></li>
            <li><code>placements[]</code> â†’ Liste aus <code>{event, place}</code></li>
          </ul>
        </div>
      </details>
    </div>

    <div class="card">
      <h2>2) Buttons & Funktionen</h2>

      <details open>
        <summary>â• Add</summary>
        <div class="small">
          Legt eine neue Person an, setzt Default-Werte und speichert in Firestore.
        </div>
      </details>

      <details>
        <summary>â­ Title</summary>
        <div class="small">
          Toggle <code>title</code>. In der MVP-Berechnung gibt es dafÃ¼r eine Strafpunkt-Regel (Title-Penalty).
        </div>
      </details>

      <details>
        <summary>ğŸš« Block / Unblock</summary>
        <div class="small">
          Blocked Personen werden bei der MVP-Berechnung ausgeschlossen.
        </div>
      </details>

      <details>
        <summary>ğŸ† MVP</summary>
        <div class="small">
          ErhÃ¶ht <code>mvpCount</code> um 1 und setzt <code>cooldownLeft</code> auf den aktuellen Cooldown.
          ZusÃ¤tzlich: Bei jedem MVP-Klick wird fÃ¼r alle Personen der Cooldown runtergezÃ¤hlt.
        </div>
      </details>

      <details>
        <summary>âœ– Entfernen</summary>
        <div class="small">
          Entfernt die Person komplett aus der Liste.
        </div>
      </details>

      <details>
        <summary>ğŸ§¾ Save Event</summary>
        <div class="small">
          Erzeugt ein neues Event (laufende Nummer), liest die Top-10-Auswahl, schreibt pro Person eine Placement:
          <ul>
            <li>Platz 1â€“10 wenn ausgewÃ¤hlt</li>
            <li>sonst default <code>place = 15</code></li>
          </ul>
        </div>
      </details>

      <details>
        <summary>ğŸ§  Calculate MVP</summary>
        <div class="small">
          Berechnet den besten Kandidaten unter den â€eligible personsâ€œ:
          <ul>
            <li>Nicht blocked</li>
            <li><code>cooldownLeft == 0</code></li>
            <li>Mindestens eine Placement vorhanden</li>
          </ul>
        </div>
      </details>
    </div>

    <div class="card">
      <h2>3) MVP-Berechnung (genau)</h2>
      <p class="kicker">
        Die App bildet aus Placements einen Durchschnitt und daraus einen Score. HÃ¶chster Score gewinnt.
      </p>

      <details open>
        <summary>Formel</summary>
        <pre><code>avgPlace = sum(place) / count(placements)

score = (20 - avgPlace) * 3 + (10 - mvpCount)

if (title) score -= TITLE_PENALTY</code></pre>
        <div class="small">
          Interpretation:
          <ul>
            <li>Besserer Schnitt (kleiner avgPlace) â†’ hÃ¶herer Score</li>
            <li>Viele frÃ¼here MVPs â†’ Score sinkt</li>
            <li>Title â†’ zusÃ¤tzliche Strafe</li>
          </ul>
        </div>
      </details>

      <details>
        <summary>Warum default place = 15?</summary>
        <div class="small">
          Damit nicht ausgewÃ¤hlte Personen im Event â€œschlechterâ€ gewertet werden, aber nicht unendlich schlecht.
        </div>
      </details>
    </div>

    <div class="card">
      <h2>4) Admin Funktionen</h2>
      <details open>
        <summary>ğŸ” Admin Unlock</summary>
        <div class="small">
          Admin-Passwort wird SHA-256 gehasht und mit <code>config/security.adminHash</code> verglichen.
          Bei Erfolg werden Import/Reset/Undo freigeschaltet.
        </div>
      </details>

      <details>
        <summary>â¬† Import JSON</summary>
        <div class="small">
          Ãœberschreibt <code>state/main</code> mit dem importierten Inhalt.
          Vorher wird automatisch ein Undo-Snapshot gespeichert.
        </div>
      </details>

      <details>
        <summary>ğŸ—‘ Reset</summary>
        <div class="small">
          Setzt <code>persons/events</code> zurÃ¼ck (leert). Vorher Undo-Snapshot.
        </div>
      </details>

      <details>
        <summary>â†© Undo</summary>
        <div class="small">
          Stellt den Stand <b>vor</b> dem letzten Import/Reset wieder her, indem <code>state/undo</code> zurÃ¼ck nach <code>state/main</code> geschrieben wird.
        </div>
      </details>
    </div>

    <div class="footer">
      Wenn du willst, kann ich dir hier zusÃ¤tzlich eine â€Quick Startâ€œ-Sektion fÃ¼r neue Clan-Mitglieder reinschreiben.
    </div>
  </div>
</div>

<script type="module" src="../assets/wiki.js"></script>
</body>
</html>